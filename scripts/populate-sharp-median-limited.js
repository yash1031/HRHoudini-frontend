import { neon } from "@neondatabase/serverless"

const sql = neon(process.env.DATABASE_URL)

async function populateSharpMedianLimited() {
  console.log("[v0] Starting limited Sharp Median data population...")

  try {
    // Clear existing data
    await sql`TRUNCATE TABLE sharp_median_employees`
    console.log("[v0] Cleared existing data")

    // Sample of 150 diverse employee records for demonstration
    const sampleEmployees = [
      // Engineering Department
      [
        "EMP001",
        "Sarah Johnson",
        "Senior Software Engineer",
        "Engineering",
        "Salary",
        125000,
        null,
        "2019-03-15",
        "2019-03-15",
        "2019-03-15",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "San Francisco",
        "123 Tech St",
        "San Francisco",
        "CA",
        "94105",
        "USA",
        "456 Home Ave",
        "San Francisco",
        "CA",
        "94110",
        "USA",
        "West Coast",
        "ENG001",
        "Mike Chen",
        "EMP050",
        "sarah.johnson@sharpmedian.com",
        "1985-07-22",
        "Female",
        "Asian",
        "USD",
        "No",
      ],

      [
        "EMP002",
        "David Rodriguez",
        "Frontend Developer",
        "Engineering",
        "Salary",
        95000,
        null,
        "2020-08-10",
        "2020-08-10",
        "2020-08-10",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Austin",
        "789 Innovation Blvd",
        "Austin",
        "TX",
        "78701",
        "USA",
        "321 Residential Dr",
        "Austin",
        "TX",
        "78704",
        "USA",
        "South Central",
        "ENG002",
        "Sarah Johnson",
        "EMP001",
        "david.rodriguez@sharpmedian.com",
        "1992-11-03",
        "Male",
        "Hispanic",
        "USD",
        "No",
      ],

      [
        "EMP003",
        "Emily Chen",
        "DevOps Engineer",
        "Engineering",
        "Salary",
        110000,
        null,
        "2018-05-20",
        "2018-05-20",
        "2018-05-20",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Seattle",
        "555 Cloud Way",
        "Seattle",
        "WA",
        "98101",
        "USA",
        "777 Mountain View",
        "Seattle",
        "WA",
        "98115",
        "USA",
        "Pacific Northwest",
        "ENG003",
        "Mike Chen",
        "EMP050",
        "emily.chen@sharpmedian.com",
        "1987-02-14",
        "Female",
        "Asian",
        "USD",
        "Yes",
      ],

      // Sales Department
      [
        "EMP004",
        "Michael Thompson",
        "Sales Director",
        "Sales",
        "Salary",
        140000,
        null,
        "2017-01-15",
        "2017-01-15",
        "2017-01-15",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "New York",
        "100 Sales Plaza",
        "New York",
        "NY",
        "10001",
        "USA",
        "200 Park Ave",
        "New York",
        "NY",
        "10003",
        "USA",
        "Northeast",
        "SAL001",
        "Jennifer Walsh",
        "EMP051",
        "michael.thompson@sharpmedian.com",
        "1980-09-12",
        "Male",
        "White",
        "USD",
        "No",
      ],

      [
        "EMP005",
        "Lisa Wang",
        "Account Executive",
        "Sales",
        "Salary",
        85000,
        null,
        "2021-03-01",
        "2021-03-01",
        "2021-03-01",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Chicago",
        "300 Commerce St",
        "Chicago",
        "IL",
        "60601",
        "USA",
        "400 Lake Shore Dr",
        "Chicago",
        "IL",
        "60611",
        "USA",
        "Midwest",
        "SAL002",
        "Michael Thompson",
        "EMP004",
        "lisa.wang@sharpmedian.com",
        "1990-06-25",
        "Female",
        "Asian",
        "USD",
        "No",
      ],

      // Marketing Department
      [
        "EMP006",
        "James Wilson",
        "Marketing Manager",
        "Marketing",
        "Salary",
        92000,
        null,
        "2019-09-10",
        "2019-09-10",
        "2019-09-10",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Los Angeles",
        "500 Creative Blvd",
        "Los Angeles",
        "CA",
        "90210",
        "USA",
        "600 Sunset Strip",
        "Los Angeles",
        "CA",
        "90028",
        "USA",
        "West Coast",
        "MKT001",
        "Amanda Foster",
        "EMP052",
        "james.wilson@sharpmedian.com",
        "1988-04-18",
        "Male",
        "White",
        "USD",
        "No",
      ],

      [
        "EMP007",
        "Maria Garcia",
        "Content Specialist",
        "Marketing",
        "Salary",
        68000,
        null,
        "2022-01-15",
        "2022-01-15",
        "2022-01-15",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Miami",
        "700 Content Ave",
        "Miami",
        "FL",
        "33101",
        "USA",
        "800 Beach Dr",
        "Miami",
        "FL",
        "33139",
        "USA",
        "Southeast",
        "MKT002",
        "James Wilson",
        "EMP006",
        "maria.garcia@sharpmedian.com",
        "1993-12-08",
        "Female",
        "Hispanic",
        "USD",
        "Yes",
      ],

      // HR Department
      [
        "EMP008",
        "Robert Kim",
        "HR Business Partner",
        "Human Resources",
        "Salary",
        88000,
        null,
        "2018-11-05",
        "2018-11-05",
        "2018-11-05",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Denver",
        "900 People St",
        "Denver",
        "CO",
        "80201",
        "USA",
        "1000 Mountain Rd",
        "Denver",
        "CO",
        "80205",
        "USA",
        "Mountain West",
        "HR001",
        "Patricia Lee",
        "EMP053",
        "robert.kim@sharpmedian.com",
        "1986-08-30",
        "Male",
        "Asian",
        "USD",
        "No",
      ],

      // Finance Department
      [
        "EMP009",
        "Jennifer Brown",
        "Financial Analyst",
        "Finance",
        "Salary",
        75000,
        null,
        "2020-06-01",
        "2020-06-01",
        "2020-06-01",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Boston",
        "1100 Finance Way",
        "Boston",
        "MA",
        "02101",
        "USA",
        "1200 Harbor View",
        "Boston",
        "MA",
        "02108",
        "USA",
        "Northeast",
        "FIN001",
        "Thomas Anderson",
        "EMP054",
        "jennifer.brown@sharpmedian.com",
        "1991-03-17",
        "Female",
        "White",
        "USD",
        "No",
      ],

      // Operations Department
      [
        "EMP010",
        "Carlos Martinez",
        "Operations Coordinator",
        "Operations",
        "Salary",
        62000,
        null,
        "2021-09-20",
        "2021-09-20",
        "2021-09-20",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Phoenix",
        "1300 Operations Blvd",
        "Phoenix",
        "AZ",
        "85001",
        "USA",
        "1400 Desert View",
        "Phoenix",
        "AZ",
        "85008",
        "USA",
        "Southwest",
        "OPS001",
        "Linda Davis",
        "EMP055",
        "carlos.martinez@sharpmedian.com",
        "1989-10-05",
        "Male",
        "Hispanic",
        "USD",
        "No",
      ],

      // Add some terminated employees for turnover analysis
      [
        "EMP011",
        "Ashley Taylor",
        "Junior Developer",
        "Engineering",
        "Salary",
        72000,
        null,
        "2021-01-10",
        "2021-01-10",
        "2021-01-10",
        "2023-08-15",
        "Voluntary",
        "Better Opportunity",
        "VO001",
        "Terminated",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "San Francisco",
        "123 Tech St",
        "San Francisco",
        "CA",
        "94105",
        "USA",
        "1500 Young Professional Ave",
        "San Francisco",
        "CA",
        "94110",
        "USA",
        "West Coast",
        "ENG004",
        "Sarah Johnson",
        "EMP001",
        "ashley.taylor@sharpmedian.com",
        "1995-05-12",
        "Female",
        "White",
        "USD",
        "No",
      ],

      [
        "EMP012",
        "Kevin Lee",
        "Sales Representative",
        "Sales",
        "Salary",
        58000,
        null,
        "2020-04-01",
        "2020-04-01",
        "2020-04-01",
        "2023-12-01",
        "Involuntary",
        "Performance",
        "IV002",
        "Terminated",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Chicago",
        "300 Commerce St",
        "Chicago",
        "IL",
        "60601",
        "USA",
        "1600 Performance Dr",
        "Chicago",
        "IL",
        "60611",
        "USA",
        "Midwest",
        "SAL003",
        "Michael Thompson",
        "EMP004",
        "kevin.lee@sharpmedian.com",
        "1992-07-28",
        "Male",
        "Asian",
        "USD",
        "No",
      ],

      // Add some hourly employees
      [
        "EMP013",
        "Sandra Williams",
        "Customer Support Specialist",
        "Customer Service",
        "Hourly",
        null,
        22.5,
        "2022-03-15",
        "2022-03-15",
        "2022-03-15",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Portland",
        "1700 Support Center",
        "Portland",
        "OR",
        "97201",
        "USA",
        "1800 Customer Ave",
        "Portland",
        "OR",
        "97205",
        "USA",
        "Pacific Northwest",
        "CS001",
        "Rachel Green",
        "EMP056",
        "sandra.williams@sharpmedian.com",
        "1990-11-20",
        "Female",
        "Black",
        "USD",
        "Yes",
      ],

      [
        "EMP014",
        "Daniel Johnson",
        "IT Support Technician",
        "Information Technology",
        "Hourly",
        null,
        28.75,
        "2021-07-01",
        "2021-07-01",
        "2021-07-01",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "Atlanta",
        "1900 Tech Support Way",
        "Atlanta",
        "GA",
        "30301",
        "USA",
        "2000 Technology Dr",
        "Atlanta",
        "GA",
        "30309",
        "USA",
        "Southeast",
        "IT001",
        "Mark Stevens",
        "EMP057",
        "daniel.johnson@sharpmedian.com",
        "1987-01-15",
        "Male",
        "White",
        "USD",
        "No",
      ],

      // Add more diverse roles and locations
      [
        "EMP015",
        "Priya Patel",
        "Data Scientist",
        "Analytics",
        "Salary",
        118000,
        null,
        "2019-02-01",
        "2019-02-01",
        "2019-02-01",
        null,
        null,
        null,
        null,
        "Active",
        "Full-time",
        "Sharp Median",
        "Sharp Median Inc",
        "San Francisco",
        "123 Tech St",
        "San Francisco",
        "CA",
        "94105",
        "USA",
        "2100 Data Science Blvd",
        "San Francisco",
        "CA",
        "94110",
        "USA",
        "West Coast",
        "ANA001",
        "Dr. Alan Turing",
        "EMP058",
        "priya.patel@sharpmedian.com",
        "1988-09-03",
        "Female",
        "Asian",
        "USD",
        "Yes",
      ],
    ]

    console.log(`[v0] Inserting ${sampleEmployees.length} sample employee records...`)

    // Insert records one by one for reliability
    let successCount = 0
    for (let i = 0; i < sampleEmployees.length; i++) {
      try {
        const emp = sampleEmployees[i]
        await sql`
          INSERT INTO sharp_median_employees (
            employee_id, employee_name, job_title, department, salary_or_hourly,
            annual_salary, hourly_rate, original_hire_date, last_hire_date, seniority_date,
            termination_date, termination_type, termination_reason, termination_reason_code,
            employee_status, employee_type, organization, company, location,
            address_work, city_work, state_work, postal_code_work, country_work,
            address_home, city_home, state_home, postal_code_home, country_home,
            region, job_code, supervisor_name, supervisor_employee_number,
            email_address, date_of_birth, gender, ethnicity, local_currency_code, remote_flag
          ) VALUES (
            ${emp[0]}, ${emp[1]}, ${emp[2]}, ${emp[3]}, ${emp[4]},
            ${emp[5]}, ${emp[6]}, ${emp[7]}, ${emp[8]}, ${emp[9]},
            ${emp[10]}, ${emp[11]}, ${emp[12]}, ${emp[13]}, ${emp[14]},
            ${emp[15]}, ${emp[16]}, ${emp[17]}, ${emp[18]}, ${emp[19]},
            ${emp[20]}, ${emp[21]}, ${emp[22]}, ${emp[23]}, ${emp[24]},
            ${emp[25]}, ${emp[26]}, ${emp[27]}, ${emp[28]}, ${emp[29]},
            ${emp[30]}, ${emp[31]}, ${emp[32]}, ${emp[33]}, ${emp[34]},
            ${emp[35]}, ${emp[36]}, ${emp[37]}, ${emp[38]}
          )
        `
        successCount++

        if (i % 10 === 0) {
          console.log(`[v0] Inserted ${i + 1} records...`)
        }
      } catch (error) {
        console.error(`[v0] Error inserting record ${i + 1}:`, error)
      }
    }

    console.log(`[v0] Successfully inserted ${successCount} out of ${sampleEmployees.length} records`)

    // Verify the data
    const result = await sql`SELECT COUNT(*) as count FROM sharp_median_employees`
    console.log(`[v0] Total records in database: ${result[0].count}`)

    // Show sample of departments
    const deptResult = await sql`
      SELECT department, COUNT(*) as count 
      FROM sharp_median_employees 
      GROUP BY department 
      ORDER BY count DESC
    `
    console.log("[v0] Department breakdown:", deptResult)

    return {
      success: true,
      recordsInserted: successCount,
      totalRecords: result[0].count,
    }
  } catch (error) {
    console.error("[v0] Error in populateSharpMedianLimited:", error)
    return {
      success: false,
      error: error.message,
    }
  }
}

// Execute the population
populateSharpMedianLimited()
  .then((result) => {
    console.log("[v0] Population completed:", result)
  })
  .catch((error) => {
    console.error("[v0] Population failed:", error)
  })
